(()=>{"use strict";!function(){let e=null;function t(e){const t=document.createElement("link");t.rel="stylesheet",t.href=e,document.head.appendChild(t)}t("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"),t("https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"),t("https://cdn.jsdelivr.net/gh/lraveri/chat-widget@main/dist/styles.css"),window.initializeChat=function(t,n,s,i,a,o){console.log("Initializing chat with baseURL:",t,"baseColor:",n,"logoURL:",s,"module:",i,"assistantId:",a,"initialMessage:",o);const d=document.createElement("div");d.id="chat-button",d.style.backgroundColor=n,d.innerHTML='<i class="fas fa-comment"></i>',document.body.appendChild(d);const c=document.createElement("div");function l(e,t){console.log("Displaying message from",t,":",e);const n=document.createElement("div");n.className=t,n.textContent=e,document.getElementById("chat-body").appendChild(n)}c.id="chat-window",c.style.visibility="hidden",c.innerHTML='\n            <div id="chat-header"> <span id="chat-close">&times;</span></div>\n            <div id="chat-body"></div>\n            <div id="chat-input-container">\n                <input id="chat-input" type="text" placeholder="Type a message..." />\n                <button id="chat-send"><i class="fas fa-paper-plane"></i></button>\n            </div>\n        ',document.body.appendChild(c),document.getElementById("chat-header").style.backgroundColor=n,c.querySelector("#chat-close").addEventListener("click",(function(){c.style.visibility="hidden"})),d.addEventListener("click",(function(){console.log("Chat button clicked"),c.style.visibility="hidden"===c.style.visibility?"visible":"hidden"})),document.getElementById("chat-send").addEventListener("click",(function(){const n=document.getElementById("chat-input"),s=n.value;""!==s.trim()&&(l(s,"user"),function(n){if(!e)return void console.error("Thread ID is not set.");l("...","assistant"),console.log("Sending message:",n);const s=new XMLHttpRequest;s.open("POST",`${t}/api/v1/${i}/chat`,!0),s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){if(4===s.readyState&&(console.log("POST response received:",s.status,s.responseText),200===s.status)){const e=JSON.parse(s.responseText),t=document.getElementById("chat-body");t.removeChild(t.lastChild),l(e.responseMessage,"assistant")}},s.send(JSON.stringify({threadId:e,message:n,assistantId:a}))}(s),n.value="")})),document.getElementById("chat-send").style.backgroundColor=n,document.getElementById("chat-input").addEventListener("keypress",(function(e){"Enter"===e.key&&document.getElementById("chat-send").click()})),console.log("Sending initial GET request to",`${t}/api/v1/${i}/start`);const r=new XMLHttpRequest;r.open("POST",`${t}/api/v1/luca/start`,!0),r.onreadystatechange=function(){if(4===r.readyState&&(console.log("GET response received:",r.status,r.responseText),200===r.status)){const t=JSON.parse(r.responseText);e=t.threadId,console.log("Received threadId:",e),""!==o&&l(o,"assistant")}},r.send(JSON.stringify({initialMessage:o}))}}()})();